<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.ea513ebfcd3448612a76.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:26px;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:1.125rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.625rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:35px;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#5d93ff}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.875rem}.Menu-module--menu--Efbin{margin-bottom:1.625rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:1rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:540px;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:2.03125rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--3nigr{font-size:1.6875rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.875rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI{font-size:1rem;color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Page-module--page--2nMky{margin-bottom:3.25rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:2.5rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--Ic6i6{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:3.25rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#5d93ff}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#5d93ff}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:40rem;padding-top:1.25rem;line-height:1.625rem;margin-top:1.625rem;margin-bottom:3.25rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:2rem;max-width:40rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.625rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:40rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.8125rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:35px;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#5d93ff}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:40rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:35px;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#5d93ff}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="Blog by Kalin Chernev" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-97001925-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-97001925-1', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=4393d44a8b1fb84b516581dca31c94be" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4393d44a8b1fb84b516581dca31c94be"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4393d44a8b1fb84b516581dca31c94be"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4393d44a8b1fb84b516581dca31c94be"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4393d44a8b1fb84b516581dca31c94be"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4393d44a8b1fb84b516581dca31c94be"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4393d44a8b1fb84b516581dca31c94be"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4393d44a8b1fb84b516581dca31c94be"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4393d44a8b1fb84b516581dca31c94be"/><title data-react-helmet="true">Multilingual Gatsby.js - Blog by Kalin Chernev</title><meta data-react-helmet="true" name="description" content="Shared thoughts on building Gatsby.js sites in many languages."/><meta data-react-helmet="true" property="og:site_name" content="Multilingual Gatsby.js - Blog by Kalin Chernev"/><meta data-react-helmet="true" property="og:image" content="https://kalinchernev.github.io//photo.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Multilingual Gatsby.js - Blog by Kalin Chernev"/><meta data-react-helmet="true" name="twitter:description" content="Shared thoughts on building Gatsby.js sites in many languages."/><meta data-react-helmet="true" name="twitter:image" content="https://kalinchernev.github.io//photo.jpg"/><link as="script" rel="preload" href="/webpack-runtime-b33d77354afa4e7afbb0.js"/><link as="script" rel="preload" href="/framework-b049b847da93b37c0f49.js"/><link as="script" rel="preload" href="/532a2f07-e3aef1b806c2b9676cfd.js"/><link as="script" rel="preload" href="/app-e9221ee962350d69b666.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-fe846209eb254c81ceac.js"/><link as="script" rel="preload" href="/643651a62fb35a9bb4f20061cb1f214a352d7976-bf398de8213e62a944ee.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-4f43b3389d9b8a8666c9.js"/><link as="fetch" rel="preload" href="/page-data/multilingual-gatsbyjs/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3691206191.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Multilingual Gatsby.js</h1><div class="Content-module--content__body--2TrQ-"><h2 id="introduction" style="position:relative;"><a href="#introduction" aria-label="introduction permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h2>
<p>There are 24 official languages in the European Union. Creating a Gatsby.js website in so many languages is an edge case for which the <a href="https://www.gatsbyjs.org/docs/localization-i18n/" target="_blank" rel="nofollow noopener noreferrer">guide on localization and internationalization with Gatsby.js</a> might not help.</p>
<p>In this article I’ll reflect on the topic of i18n with Gatsby.js, the available plugins and core APIs. Mostly, how to use core APIs to create a scalable system for delivering multilingual static sites.</p>
<h2 id="problem-analysis" style="position:relative;"><a href="#problem-analysis" aria-label="problem analysis permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Problem analysis</h2>
<p>In my opinion, when evaluating approaches/tools for multilingualism with Gatsby.js, the solution should:</p>
<ul>
<li>Produce translated strings in both client/server rendered components.</li>
<li>Follow best practices, using battle-tested utilities.</li>
<li>Follow React.js patterns.</li>
</ul>
<p>In short, the tool or the approach taken to solve the issue should be maintenable.</p>
<h2 id="research" style="position:relative;"><a href="#research" aria-label="research permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Research</h2>
<p>When working on a Gatsby.js project, a research phase would usually consist of browing the following sources:</p>
<ul>
<li><a href="https://www.gatsbyjs.org/plugins/" target="_blank" rel="nofollow noopener noreferrer">Community plugins</a></li>
<li><a href="https://github.com/gatsbyjs/gatsby/tree/master/packages" target="_blank" rel="nofollow noopener noreferrer">Core plugins</a></li>
<li><a href="https://github.com/gatsbyjs/gatsby/tree/master/examples" target="_blank" rel="nofollow noopener noreferrer">Examples</a></li>
</ul>
<p>When it comes to researching for “i18n”:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 696px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e727557e69d90cdca045210eea438905/82158/i18n-plugins-gatsbyjs.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 163.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAYAAADZPosTAAAACXBIWXMAAAsTAAALEwEAmpwYAAADIUlEQVRIx61W227bMAz15+9P9gF93fYyDGlXIEXaBGmLtmkSoEhmx/e7Y3M6VCjYro20wwQQFmX5iOQhKVv1sabdq09ZWtDxWFFRFCSjaRqq65rneEJv6kavH7XefodhJWFOX7/8ot8/Z/T9xze6uLigxWLBLwH+ulrT4eBSmqT0/Lxi3XVdSryC7HVA0SGjOE54ff26IQvIaQTrjpTnOWVZxiIWVlXF7zAvy4p1WFSkFYV2Somfm31lWWpA+bg98JFx8+S6zCFFVlGmDMmT0oQF65acDCuSJKEoitSGxgCOCQNTY6yTNe1ymnG8VquVitPzycKmY9GYwJAsy7uAWlruHuuzFo5ZbeEEz/MUkwcKw1AS5iSfG8bC9in9DZ8VS4JaFCXHA9RD0jQ1bghJ/Y/bRmC/4zhkYTKZTOjm5kbJlOfzxZyur6+Z9SG3JMVAJMKFAbD7+3sdQ9/3VfwijmEQhCp1YtZRAQBFlYRqvZ3wwGyXJgAfHh7IAqOu61HgB5oc56AOCMj3fAbBIchNV5Ufnu0iaFtrAP+FyaHKMoBwebfbGdnv993uMiIYIFPCYNs2LZdLsrAAQhBQLDw9PX3YWjQThAWHG5ahRIoACAgIgoBjiBaFORLe5/jqmELHvJ+zsBagGlCxGscxswoSUJtgFhsgudKLvGCLsAde9d1H7gLj06T0yZEBQHhoITnn8znH8PHxkeeII55gDacOlaHEULe7uguIlrXdbmmz2dDLywu9vb2xrNfrXjK/dxPvO4BQUB2oFpyG5MYTeqLiZf+xOdmZDFUA+92e2eyTYgClSULAlHRfWev3O1nrV4oBHAt4P+jn9hhAxODq6oqTezab8RyE3N3dnU9slU7IVWl7DAgXHRUjndA+x0rnZMztSfojz1XP1L2zMBZWlVyxLVLQbXCZowJAAlqXd1oTMlh39DXh2A4DD5JC/2n00iYwbmIuNS3/OWPdBt+KpZ3Enk6ndHt7S5eXl/oKmOsrAMk9xKjMQSjytkMKFFiWpfqfBs1AqmOoZs/Wsu42EQuAwTSe7V+0MQs/nNjnrBvaI4B/AbEcCxLl/RYTAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/e727557e69d90cdca045210eea438905/8ac56/i18n-plugins-gatsbyjs.webp 240w,
/static/e727557e69d90cdca045210eea438905/d3be9/i18n-plugins-gatsbyjs.webp 480w,
/static/e727557e69d90cdca045210eea438905/038cb/i18n-plugins-gatsbyjs.webp 696w"
              sizes="(max-width: 696px) 100vw, 696px"
              type="image/webp"
            />
          <source
            srcset="/static/e727557e69d90cdca045210eea438905/8ff5a/i18n-plugins-gatsbyjs.png 240w,
/static/e727557e69d90cdca045210eea438905/e85cb/i18n-plugins-gatsbyjs.png 480w,
/static/e727557e69d90cdca045210eea438905/82158/i18n-plugins-gatsbyjs.png 696w"
            sizes="(max-width: 696px) 100vw, 696px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/e727557e69d90cdca045210eea438905/82158/i18n-plugins-gatsbyjs.png"
            alt="i18n plugins Gatsby.js"
            title="i18n plugins Gatsby.js"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>Trying to get information about the first one <code class="language-text">gatsby-plugin-i18n</code>, it leads to Github search <code class="language-text">https://github.com/search?q=gatsby-plugin-i18n</code> which shows several repositories, some of them are forks of a very close relation.</p>
<p>The first one <a href="https://github.com/angeloocana/gatsby-plugin-i18n" target="_blank" rel="nofollow noopener noreferrer">angeloocana/gatsby-plugin-i18n</a> uses <code class="language-text">react-intl</code> and <code class="language-text">i18next</code>. Looks promising with over 210 stars and separate packages for per-topic solutions. However, it automatically goes out of the shortlist - it will not be ok to have 24 files for every single page. Imagine a site with 10 pages which will explode to managing 240 files for a simple site!</p>
<p>The second one <a href="https://github.com/ikhudo/gatsby-i18n-plugin" target="_blank" rel="nofollow noopener noreferrer">ikhudo/gatsby-i18n-plugin</a> also uses <code class="language-text">i18next</code>. Has an unofficial? mirror at <a href="https://github.com/hupe1980/gatsby-i18n" target="_blank" rel="nofollow noopener noreferrer">hupe1980/gatsby-i18n</a>. Looking at code of <code class="language-text">gatsby-i18n</code> and <code class="language-text">gatsby-plugin-i18next</code> packages we see that documentation is scarce and both haven’t been updated very frequently.</p>
<p>That’s confusing: <code class="language-text">gatsby-plugin-18</code> vs <code class="language-text">gatsby-18n-plugin</code>, first being a “no-no” and second one being “can’t start the starters”. 🤔</p>
<p>The third plugin in the list is <a href="https://github.com/wiziple/gatsby-plugin-intl" target="_blank" rel="nofollow noopener noreferrer"><code class="language-text">wiziple/gatsby-plugin-intl</code></a> uses <code class="language-text">react-intl</code>. Shares approach and issues mentioned in <code class="language-text">angeloocana/gatsby-plugin-i18n</code>: we can’t afford per-language page.</p>
<p>Lastly, checking whether any of the top (most downloaded) plugins is used in a <a href="https://github.com/gatsbyjs/gatsby/tree/master/packages" target="_blank" rel="nofollow noopener noreferrer">core plugin</a> or an <a href="https://github.com/gatsbyjs/gatsby/tree/master/examples/using-i18n" target="_blank" rel="nofollow noopener noreferrer">example</a>: the answer is no.</p>
<p>It’s easy to see that <code class="language-text">react-intl</code> and <code class="language-text">i18next</code> are the go-to solutions in terms of using i18n frameworks, though at the same time</p>
<p><strong>top plugins are either not scalable or are not production-ready.</strong></p>
<p>Coming back to <code class="language-text">wiziple/gatsby-plugin-intl</code> plugin which has a special <a href="https://github.com/wiziple/gatsby-plugin-intl#why" target="_blank" rel="nofollow noopener noreferrer"><strong>WHY</strong> section</a>:</p>
<blockquote>
<p>When you build multilingual sites, Google recommends using different URLs for each language version of a page rather than using cookies or browser settings to adjust the content language on the page.</p>
</blockquote>
<p>Looking at the <a href="https://github.com/gatsbyjs/gatsby/tree/master/examples/using-i18n" target="_blank" rel="nofollow noopener noreferrer">example of using i18n</a> it says:</p>
<blockquote>
<p>Example site that demonstrates how to build Gatsby sites with multiple languages (Internationalization / i18n) without any third-party plugins or packages. Per language a dedicated page is built (so no client-side translations) which is among other things important for SEO.</p>
</blockquote>
<p>Having these and the awareness about the state of i18n plugins, it’s natural to start on a new path of thinking: <strong>HOW</strong> to solve the problem without plugins?</p>
<h2 id="createpage-and-pagecontext" style="position:relative;"><a href="#createpage-and-pagecontext" aria-label="createpage and pagecontext permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>createPage() and pageContext</h2>
<p>From the previous section we reached a point where we know that we can achieve i18n with functions from Gatsby.js’s core. Let’s make a short analysis of the <a href="https://github.com/gatsbyjs/gatsby/tree/master/examples/using-i18n" target="_blank" rel="nofollow noopener noreferrer">reference example</a>.</p>
<p>Starting from <code class="language-text">gatsby-node.js</code>, the file where we can use <a href="https://www.gatsbyjs.org/docs/node-apis/" target="_blank" rel="nofollow noopener noreferrer">Gatsby Node APIs</a>, we see <a href="https://github.com/gatsbyjs/gatsby/blob/master/examples/using-i18n/gatsby-node.js#L17-L39" target="_blank" rel="nofollow noopener noreferrer">usage of <code class="language-text">createPage()</code></a>:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>locales<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">lang</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Use the values defined in "locales" to construct the path</span>
  <span class="token keyword">const</span> localizedPath <span class="token operator">=</span> locales<span class="token punctuation">[</span>lang<span class="token punctuation">]</span><span class="token punctuation">.</span>default
    <span class="token operator">?</span> page<span class="token punctuation">.</span>path
    <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>locales<span class="token punctuation">[</span>lang<span class="token punctuation">]</span><span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token function">createPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// Pass on everything from the original page</span>
    <span class="token operator">...</span>page<span class="token punctuation">,</span>
    <span class="token comment">// Since page.path returns with a trailing slash (e.g. "/de/")</span>
    <span class="token comment">// We want to remove that</span>
    path<span class="token operator">:</span> <span class="token function">removeTrailingSlash</span><span class="token punctuation">(</span>localizedPath<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// Pass in the locale as context to every page</span>
    <span class="token comment">// This context also gets passed to the src/components/layout file</span>
    <span class="token comment">// This should ensure that the locale is available on every page</span>
    context<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>page<span class="token punctuation">.</span>context<span class="token punctuation">,</span>
      locale<span class="token operator">:</span> lang<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>This is already solving our issue with scalability, because we can define a list of 24 languages and loop through them, having a separate page for each language without creating physical files.</p>
<p>The part about <code class="language-text">context</code> and <code class="language-text">locale</code> is an example of how to <a href="https://www.gatsbyjs.org/docs/gatsby-internals-terminology/#pagecontext" target="_blank" rel="nofollow noopener noreferrer">pass a variable to GraphQL queries in Gatsby.js</a>, which can be seen in <a href="https://github.com/gatsbyjs/gatsby/blob/master/examples/using-i18n/src/pages/index.js#L35" target="_blank" rel="nofollow noopener noreferrer">code here</a>.</p>
<p>At the same time, passing data to <code class="language-text">context</code> is related to how <a href="https://www.gatsbyjs.org/docs/write-pages/" target="_blank" rel="nofollow noopener noreferrer">Gatsby.js creates pages</a>. For example, the <code class="language-text">public/page-data/de/page-data.json</code> of the example will contain:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"componentChunkName"</span><span class="token operator">:</span> <span class="token string">"component---src-pages-index-js"</span><span class="token punctuation">,</span>
  <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"/de"</span><span class="token punctuation">,</span>
  <span class="token property">"webpackCompilationHash"</span><span class="token operator">:</span> <span class="token string">"ed7057ec19fc05f78011"</span><span class="token punctuation">,</span>
  <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"data"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"pageContext"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"isCreatedByStatefulCreatePages"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">"locale"</span><span class="token operator">:</span> <span class="token string">"de"</span><span class="token punctuation">,</span>
      <span class="token property">"dateFormat"</span><span class="token operator">:</span> <span class="token string">"DD.MM.YYYY"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>I’ve skipped <code class="language-text">result.data</code> to focus on <code class="language-text">result.pageContext.locale</code> 😉.</p>
<p>The example implementation is already clearly stating:</p>
<blockquote>
<p>Usage of a custom hook with GraphQL to access translations. That part can be replaced with a i18n library</p>
</blockquote>
<p>This means that the <a href="https://github.com/gatsbyjs/gatsby/blob/master/examples/using-i18n/src/components/useTranslations.js" target="_blank" rel="nofollow noopener noreferrer"><code class="language-text">useTranslations()</code></a></p>
<p>having the following implementation might need reconsideration:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> query <span class="token operator">=</span> graphql`
  query useTranslations <span class="token punctuation">{</span>
    rawData<span class="token operator">:</span> <span class="token function">allFile</span><span class="token punctuation">(</span>filter<span class="token operator">:</span> <span class="token punctuation">{</span> sourceInstanceName<span class="token operator">:</span> <span class="token punctuation">{</span> eq<span class="token operator">:</span> <span class="token string">"translations"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      edges <span class="token punctuation">{</span>
        node <span class="token punctuation">{</span>
          name
          translations<span class="token operator">:</span> childTranslationsJson <span class="token punctuation">{</span>
            hello
            subline
            backToHome
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>And you might already see a few potential drawbacks of this approach:</p>
<ul>
<li>Each field to be used needs to be query-ied. Could be ok for a few fields, but what happens with a page of 30+ strings?</li>
<li>What about nested structures?</li>
<li>Data is <a href="https://www.gatsbyjs.org/docs/sourcing-from-the-filesystem/" target="_blank" rel="nofollow noopener noreferrer">sourced</a> which is ok for a use case of having a few files, but what happens on multiplication by 24?</li>
</ul>
<p>Using sourcing and GraphQL for pulling data into components demonstrates a good pattern of enabling usage of data on SSR, though it might not be the most scalabale approach for the long term.</p>
<h2 id="i18n-library" style="position:relative;"><a href="#i18n-library" aria-label="i18n library permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>i18n library</h2>
<p>Let’s try to implement an i18n library in the example. For the demonstration we’ll select i18next.</p>
<p>Following the <a href="https://react.i18next.com/guides/quick-start" target="_blank" rel="nofollow noopener noreferrer">quick start</a>, the example would have a basic implementation <a href="https://github.com/kalinchernev/using-i18n/commit/84702c14343b12ed83e81624df7c3d6dacb3d116" target="_blank" rel="nofollow noopener noreferrer">like this</a></p>
<p>NB: <code class="language-text">gatsby-plugin-layout</code> is used for convenience and simplification, not directly related to integration of i18next.</p>
<p>At this stage, a component can use <code class="language-text">useTranslation</code> in the following way:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useTranslation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-i18next'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> LocaleContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../layouts'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Welcome</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> locale <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>LocaleContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> t<span class="token punctuation">,</span> i18n <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useTranslation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  i18n<span class="token punctuation">.</span><span class="token function">changeLanguage</span><span class="token punctuation">(</span>locale<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Using i18next'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Welcome<span class="token punctuation">;</span></code></pre></div>
<p>Yes, the <code class="language-text">changeLanguage()</code> will be taken out to be more generic, as well as <code class="language-text">LocaleContext</code> does not need stay in the <code class="language-text">layout</code> any more, but we have a working example with 2 ways of translating content.</p>
<h2 id="refactoring" style="position:relative;"><a href="#refactoring" aria-label="refactoring permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Refactoring</h2>
<p>As a <a href="https://github.com/kalinchernev/using-i18n/commit/1600a7bb28bff0ddb3d888d7ca00a3d765e8df7e" target="_blank" rel="nofollow noopener noreferrer">first step of refactoring</a> the current implementation, we can do the following:</p>
<ul>
<li>Take out <code class="language-text">resources</code> from the configuration file, as suggested in i18next quick start.</li>
<li>Use <a href="https://react.i18next.com/latest/i18nextprovider" target="_blank" rel="nofollow noopener noreferrer"><code class="language-text">I18nextProvider</code></a> to pass <code class="language-text">i18n</code> instance down to children, rather than relying on <code class="language-text">use(initReactI18next)</code> middleware.</li>
<li>Change locale/language context from the layout component.</li>
</ul>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  i18n<span class="token punctuation">.</span><span class="token function">changeLanguage</span><span class="token punctuation">(</span>locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>locale<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>The surface of implementation in components now works as following:</li>
</ul>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useTranslation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-i18next'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Welcome</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> t <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useTranslation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Using i18next'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Welcome<span class="token punctuation">;</span></code></pre></div>
<p>We still make use of the <a href="https://reactjs.org/docs/context.html" target="_blank" rel="nofollow noopener noreferrer">Context API</a> and we are able to access both <code class="language-text">location</code> and <code class="language-text">i18n</code> from components’, regardless of their location in the hierarchy. No props drillin’.</p>
<p>However, after moving <code class="language-text">resources</code> to an external file and <code class="language-text">import</code>-ing it, we end up with:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 734px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1d11b8e63241f27a1c38fd1fa5b41fe4/c6d67/i18n-client-side.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACN0lEQVQ4y41UyXLaQBDV1+eccyqu5JhTLqnENgEDBrSZRULbII0AAZJASLhI5f7SM8JlqkJiDq96tHT369fdo+xTB8zXwGcmyszFYeu9ieedhyyxUJLvVL9FzDQM9Xv8rkIoVe5it7FREMpsiipzyNbYp9OLEP/t1pb0WXET2XKMdDHEr3IGRbwcmXcwtR8YGrfQB9/xRFkNeuZeB7Hf/Qvc62IedBE6HQR2B+64DWa3JQklXYwwZwNEfg+L2QDLE8R5FWlvIglVJJGBeKZLKRRB3Zk0YY9+Yua0sWQ9yv54PYjxMhzAUO8poC8C2sRGlxoIm0QmqvxVx2sg+0DEjntWa+hMWhibDfjWA2XtURkDmfVaiP/nVNlh69YBgykJa7XBScckUmt9+PVYc136nDS0EQfUAG6Ak+X+4J/j8j8U68lryWIEFuxF6K60kdu+CO6dQT53EDktfPn8HmlsQhGiJnyE0FNJD10OqmBcigGW2e16mE/nYmNhv6ntOdbxqO5ylfsoll2sQkI8xmZO3Q4N5CuLNmCCLXVPnPNEnG1UtHplTitIzs9FQEECGSiPWzgWpOF27eOYfMUuboC5Gu2lijmNT0RaBvYjMe9j5vbpW4/K6yMRQ+/3kc1pvDYTlKRdRavodt/hkA7rXS4ynxw1GSTyqEHxE5WtyaXngSqDLvkQyfAb2N0HxA+fwBo3iJo3ZD+CjZvgzHwpmW4YQnUB9eCevSMmglFJmh1SixiecLpIjgXDH2MAI82wmqv8AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/1d11b8e63241f27a1c38fd1fa5b41fe4/8ac56/i18n-client-side.webp 240w,
/static/1d11b8e63241f27a1c38fd1fa5b41fe4/d3be9/i18n-client-side.webp 480w,
/static/1d11b8e63241f27a1c38fd1fa5b41fe4/a242a/i18n-client-side.webp 734w"
              sizes="(max-width: 734px) 100vw, 734px"
              type="image/webp"
            />
          <source
            srcset="/static/1d11b8e63241f27a1c38fd1fa5b41fe4/8ff5a/i18n-client-side.png 240w,
/static/1d11b8e63241f27a1c38fd1fa5b41fe4/e85cb/i18n-client-side.png 480w,
/static/1d11b8e63241f27a1c38fd1fa5b41fe4/c6d67/i18n-client-side.png 734w"
            sizes="(max-width: 734px) 100vw, 734px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/1d11b8e63241f27a1c38fd1fa5b41fe4/c6d67/i18n-client-side.png"
            alt="i18n client-side"
            title="i18n client-side"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>Which is not ideal, because although we see translations in the browser on language switching, the resulting HTML pages are not having the translations in their corresponding languages, but in defaults. Translation happens client-side.</p>
<h2 id="loading-translations-resources-for-server-side-rendering-ssr" style="position:relative;"><a href="#loading-translations-resources-for-server-side-rendering-ssr" aria-label="loading translations resources for server side rendering ssr permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loading translations resources for server-side rendering (SSR)</h2>
<p>After <a href="https://github.com/kalinchernev/using-i18n/commit/27d4791b37e0f2bd9df49cdfd74fc35c88676fa4" target="_blank" rel="nofollow noopener noreferrer">second refactoring</a>:</p>
<ul>
<li>The <code class="language-text">localeContext</code> is taken out from the layout component and moved to a separate file in order to avoid circular dependencies.</li>
<li><a href="https://github.com/kalinchernev/using-i18n/commit/27d4791b37e0f2bd9df49cdfd74fc35c88676fa4#diff-fda05457e393bada716f508859bfc604R9" target="_blank" rel="nofollow noopener noreferrer"><code class="language-text">resources</code> are <code class="language-text">require</code>-ed</a> in <code class="language-text">gatsby-node.js</code> and information is passed through <code class="language-text">context</code> again. Example: <code class="language-text">public/page-data/de/page-data.json</code></li>
</ul>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token string">"componentChunkName"</span><span class="token operator">:</span> <span class="token string">"component---src-pages-index-js"</span><span class="token punctuation">,</span>
  <span class="token string">"path"</span><span class="token operator">:</span> <span class="token string">"/de"</span><span class="token punctuation">,</span>
  <span class="token string">"webpackCompilationHash"</span><span class="token operator">:</span> <span class="token string">"723c1b4c311ddaa3bf91"</span><span class="token punctuation">,</span>
  <span class="token string">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">"data"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"pageContext"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">"isCreatedByStatefulCreatePages"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token string">"locale"</span><span class="token operator">:</span> <span class="token string">"de"</span><span class="token punctuation">,</span>
      <span class="token string">"localeResources"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">"translation"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">"Using i18next"</span><span class="token operator">:</span> <span class="token string">"Using i18next (DE)"</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">"dateFormat"</span><span class="token operator">:</span> <span class="token string">"DD.MM.YYYY"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li><a href="https://github.com/kalinchernev/using-i18n/commit/27d4791b37e0f2bd9df49cdfd74fc35c88676fa4#diff-8be0da79bbc6e745de5b15ad04fefb43" target="_blank" rel="nofollow noopener noreferrer">i18next’s initialization</a> moved to a separate file.</li>
<li>A <a href="https://reactjs.org/docs/higher-order-components.html" target="_blank" rel="nofollow noopener noreferrer">HOC</a> added, takes providers from layout component and passes <code class="language-text">i18n</code> instance and <code class="language-text">locale</code> to children. It’s inspired by <a href="https://github.com/ikhudo/gatsby-i18n-plugin/blob/master/packages/gatsby-plugin-i18next/src/withI18next.js" target="_blank" rel="nofollow noopener noreferrer">this</a>).</li>
</ul>
<h2 id="summary" style="position:relative;"><a href="#summary" aria-label="summary permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Summary</h2>
<p>The multilingual setup we end up with uses core functionalities without plugins: i18next, React patterns (HOC), Context API, hooks, and Gatsby’s <code class="language-text">createPage()</code>, which facilitate the data management.</p>
<p>Plugins do have their role into solving problems when they are in a specific scope or when they provide enough flexibility in terms of implementation. I think the reason the i18n plugins won’t be the best fit for all types of multilingual sites is that they make assumptions which impose constraints on scalability of the project using them.</p>
<p>I hope this was a useful read for getting the way of thinking rather than the framework specifics.</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->2 Sep 2019</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/i-18-n/">i18n</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/l-10-n/">l10n</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/java-script/">JavaScript</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/gatsby-js/">GatsbyJS</a></li></ul></div><div class="Author-module--author--2Yefr"><p>Writing crystallizes thought and thought produces action.<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/kalinchernev" rel="noopener noreferrer" target="_blank"><strong>Kalin Chernev</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"><div><div id="disqus_thread"></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/multilingual-gatsbyjs";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-f8d6bc3f3d1ba44ac510.js"],"app":["/app-e9221ee962350d69b666.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-f7b079ddd7a4fd06c613.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-53ef561a57c114039f20.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-414b20f9d2d9c8628e11.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-10c4ddfa58d37ed4c996.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-62505f2010a095b56766.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-968ad080bef0b959da78.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-4f43b3389d9b8a8666c9.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-4a08c5a770f26d3f3041.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-ed68fd5855bcffe5736f.js"]};/*]]>*/</script><script src="/polyfill-f8d6bc3f3d1ba44ac510.js" nomodule=""></script><script src="/component---src-templates-post-template-js-4f43b3389d9b8a8666c9.js" async=""></script><script src="/643651a62fb35a9bb4f20061cb1f214a352d7976-bf398de8213e62a944ee.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-fe846209eb254c81ceac.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-e9221ee962350d69b666.js" async=""></script><script src="/532a2f07-e3aef1b806c2b9676cfd.js" async=""></script><script src="/framework-b049b847da93b37c0f49.js" async=""></script><script src="/webpack-runtime-b33d77354afa4e7afbb0.js" async=""></script></body></html>